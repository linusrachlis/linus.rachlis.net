/*
Thanks to Franklin Ta for the matrix3d transform calculator:
http://franklinta.com/2014/09/08/computing-css-matrix3d-transforms/
*/

@import "h5b-before";


@mixin animation($v) {
  animation: $v;
  -webkit-animation: $v;
}
@mixin animation-delay($v) {
  animation-delay: $v;
  -webkit-animation-delay: $v;
}
@mixin animation-duration($v) {
  animation-duration: $v;
  -webkit-animation-duration: $v;
}


html { height: 100%; }
body {
    height: 100%;
    background: #222;
}

/* Home page */
body.index {
  nav {
      position: absolute;
  }
  nav .label {
      position: absolute;
      top: 2%;
      left: 5%;
      font-family: Consolas, "Courier New", monospace;
      color: white;
      opacity: 0;
      transition: all 1s;
  }
  nav .label.active {
      top: 4%;
      opacity: 1;
      transition: all 500ms;
  }

  /* This business accomplishes the same thing as background-size: contain.
     But there is a reason to go through it. If I went the background route,
     I wouldn't be able to read back out the image's changing dimensions.
     Using an img lets me use the browser's natural habit of maintaining an
     img element's aspect ratio to also update the nav container's dimensions.
     (See main.js.) */
  @media (min-aspect-ratio: 2033/1475) {
      /* Viewport is wider than image aspect ratio, so constrain height */
      img.bg {
          height: 100%;
          max-height: 1475px;
      }

  }
  @media (max-aspect-ratio: 2033/1475) {
      /* Viewport is taller than image aspect ratio, so constrain width */
      img.bg {
          width: 100%;
          max-width: 2033px;
      }
  }

  nav img.shift {
      position: absolute;
      left: 82.14461%;
      top: 40.40678%;
      width: 17.855386%;
      height: 16.474576%;
      opacity: 0;
      transition: opacity 1s;
  }
  nav img.shift.on {
      opacity: 1;
      transition: opacity 500ms;
  }

  nav ul {
      position: absolute;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
  }
  nav ul li {
      position: absolute;
      margin: 0;
      padding: 0;
  }
  nav ul li a {
      display: block;
      width: 100%;
      height: 100%;
      overflow: hidden;
      text-indent: -9999em;
      background: top left no-repeat;
      background-size: contain;
      opacity: 0;
      transition: opacity 1s;
  }

  nav ul.idle li a {
      @include animation(pulse-faint alternate infinite);
  }
  nav ul.idle li.contact a {
      @include animation-delay(1s);
      @include animation-duration(0.8s);
  }
  nav ul.idle li.resume a {
      @include animation-delay(2s);
      @include animation-duration(1s);
  }
  nav ul.idle li.poetry a {
      @include animation-delay(3s);
      @include animation-duration(1.2s);
  }
  nav ul.idle li.experiments a {
      @include animation-delay(4s);
      @include animation-duration(1.4s);
  }

  nav ul li a:hover {
      @include animation(none);
      opacity: 1;
      transition: opacity 500ms;
  }

  nav ul li.resume {
      left: 24.495%;
      top: 54.101%;
      width: 16.182%;
      height: 18.033%;
  }
  nav ul li.resume a {
      background-image: url(../img/light-r.jpg);
  }
  nav ul li.poetry {
      left: 63.0103%;
      top: 38.2373%;
      width: 14.36301%;
      height: 14.101695%;
  }
  nav ul li.poetry a {
      background-image: url(../img/light-p.jpg);
  }
  nav ul li.contact {
      left: 2.9513%;
      top: 55.7966%;
      width: 15.00246%;
      height: 17.7627%;
  }
  nav ul li.contact a {
      background-image: url(../img/light-2.jpg);
  }
  nav ul li.experiments {
      left: 47.31923%;
      top: 39.457627%;
      width: 13.1825%;
      height: 13.6949%;
  }
  nav ul li.experiments a {
      background-image: url(../img/light-8.jpg);
  }
}


/* Contact page */
body.contact {
  
  @media (min-aspect-ratio: 2300/1725) {
    /* Viewport is wider than image aspect ratio, so constrain height */
    img.bg {
        height: 100%;
        max-height: 1725px;
    }

  }
  
  @media (max-aspect-ratio: 2300/1725) {
      /* Viewport is taller than image aspect ratio, so constrain width */
      img.bg {
          width: 100%;
          max-width: 2300px;
      }
  }
  
  .container { position: absolute; }
  
  .up {
    display: block;
    width: 720px;
    height: 48px;
    position: absolute;
    left: 61px;
    top: 89px;
    overflow: hidden;
    text-indent: -9999em;
  }

  ul.contact-methods {
    position: absolute;
    left: 150/2300 * 100%;
    top: 287/1725 * 100%;
    font-family: Consolas, Monaco, monospace;
    margin: 0;
    padding: 0;
    list-style: none;
    transform: matrix3d(1.19101442903179, -0.0168426282893385, 0, 0.000711174501382491, 0.157686656711765, 1.01970704673608, 0, 0.000154181074065636, 0, 0, 1, 0, 0, 0, 0, 1);
    transform-origin: 0px 0px 0px;
    
    li {
      margin: 0;
      padding: 0;
      
      a {
        display: block;
        color: white;
        text-decoration: none;
        
      }
      a:hover {
        color: #feffa3;
      }
    }
  }
  
}



/* Poetry page */
body.poetry {
  
  @media (min-aspect-ratio: 1725/2300) {
    /* Viewport is wider than image aspect ratio, so constrain height */
    img.bg {
        height: 100%;
        max-height: 2300px;
    }

  }
  
  @media (max-aspect-ratio: 1725/2300) {
      /* Viewport is taller than image aspect ratio, so constrain width */
      img.bg {
          width: 100%;
          max-width: 1725px;
      }
  }
  
  a {
    color: white;
    text-decoration: none;
  }
  
  a.back {
    font-size: 200%;
    display: block;
    position: absolute;
    left: 2%;
    top: 2%;
    @include animation(pulse-full 1.5s infinite alternate);
  }
  
  .container {
    position: absolute;
    
    ::-webkit-scrollbar {
        width: 3%;
    }
    ::-webkit-scrollbar-track {
        background-color: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background-color: rgba(255,255,255,0.2);
      border-radius: 12px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255,255,255,0.4);
    }
  }
  
  .poems {
    position: absolute;
    left: 10%;
    top: 10%;
    width: 49%;
    height: 69%;
    padding: .5em;
    overflow-y: auto;
    font-family: 'Radley', serif;
    color: white;
    text-shadow: 0 0 1em black;
    transform: matrix3d(1.0455525626369, 0.0653322338474679, 0, 0.000135802973950249, -0.00779532730817718, 1.2165199183822, 0, 0.000826077336026331, 0, 0, 1, 0, -1, -15, 0, 1);
    transform-origin: 0px 0px 0px;

    > ul {
      list-style: none;
      margin: 0 0 80% 0;
      padding: 0;
      
      > li {
        margin: 1em 0 0 0;
        font-style: italic;
        
        ul {
          list-style: none;
          margin: 0 0 0 1em;
          padding: 0;
          font-size: 140%;
          font-style: normal;
          
          li {
            text-indent: -1em;
          }
          
          a {
            opacity: 1;
            transition: opacity .5s;
          }
          a:hover {
            opacity: .6;
            transition: opacity .2s;
          }
        }
      }
    }
  }
  
}



/* Animations */

@keyframes pulse-faint {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 0.4;
    }
}
@-webkit-keyframes pulse-faint {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 0.4;
    }
}

@keyframes pulse-full {
    0% {
        opacity: 0.6;
    }
    100% {
        opacity: 1;
    }
}
@-webkit-keyframes pulse-full {
    0% {
        opacity: 0.6;
    }
    100% {
        opacity: 1;
    }
}


@import "h5b-after";
